---
title: "Data_Analysis_Project"
author: "Isabelle Jensen, Sonia Vargas"
date: "11/16/24"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
This project explores cast vote records (CVRs) from the Maryland 2024 primary elections to uncover trends, patterns, and insights into voter behavior. By examining these detailed voting records, we aim to answer several newsworthy questions about the electoral process, such as straight-ticket voting rates, undervoting in down-ballot races, and the influence of ballot styles on voter choices.

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(janitor)
library(lubridate)
library(dplyr)
library(readxl)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary 
for data you are working with, and discuss any caveats or issues you discovered 
working with this data. 

This data is pretty huge, but this is a collection of all of the data if we were to want to load all of them.

```{r}
Alleghany <- read_excel("data/01_Allegany PP24 CVRs/01PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Alleghany")
AnneArundel <- read_excel("data/02_Anne Arundel PP24 CVRs/02PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Anne Arundel")
BaltimoreCity <- read_excel("data/03_Baltimore City PP24 CVRs/03PP24_Prov_CVR_SBE.xlsx") |>   mutate(County = "Baltimore City")
BaltimoreCounty <- read_excel("data/04_Baltimore County PP24 CVRs/04PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Baltimore County")
Calvert <- read_excel("data/05_Calvert PP24 CVRs/05PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Calvert")
Caroline <- read_excel("data/06_Caroline PP24 CVRs/06PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Caroline")
Carroll <- read_excel("data/07_Carroll PP24 CVRs/07PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Carroll")
Cecil <- read_excel("data/08_Cecil PP24 CVRs/08PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Cecil")
Charles <- read_excel("data/09_Charles PP24 CVRs/09PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Charles")
Dorchester <- read_excel("data/10_Dorchester PP24 CVRs/10PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Dorchester")
Frederick <- read_excel("data/11_Frederick PP24 CVRs/11PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Frederick")
Garrett <- read_excel("data/12_Garrett PP24 CVRs/12PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Garrett")
Harford <- read_excel("data/13_Harford PP24 CVRs/13PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Harford")
Howard <- read_excel("data/14_Howard PP24 CVRs/14PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Howard")
Kent <- read_excel("data/15_Kent PP24 CVRs/15PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Kent")
Montgomery <- read_excel("data/16_Montgomery PP24 CVRs/16PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Montgomery")
PG <- read_excel("data/17_Prince George's PP24 CVRs/17PP24_Prov_CVR_SBE.xlsx") |>
  mutate(County = "Prince George's")
QueenAnnes <- read_excel("data/18_Queen Annes PP24 CVRs/18PP24_Prov_CVR_SBE.xlsx") |>
  mutate(County = "Queen Anne's")
StMarys <- read_excel("data/19_St Marys PP24 CVRs/19PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "St Marys")
Somerset <- read_excel("data/20_Somerset PP24 CVRs/20PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Somerset")
Talbot <- read_excel("data/21_Talbot PP24 CVRs/21PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Talbot")
Washington <- read_excel("data/22_Washington PP24 CVRs/22PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Washington")
Wicomico <- read_excel("data/23_Wicomico PP24 CVRs/23PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Wicomico")
Worcester <- read_excel("data/24_Worcester PP24 CVRs/24PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Worcester")
  
```

## Questions to explore
1. What is the proportion of Straight-Ticket Voting?
2. What are the Undervoting Rates in Down-Ballot Races?
3. Are there certain Precincts that behave similarly due to some aspects?
4. How much Ballot Splitting can we see in the cast vote records?
5. What is the Impact of Ballot Style on Voting Patterns in Local Races?

## Deliverable 2 (week 12) - 10 percent: 
For a quick overlook of a few interesting counties in MD: 
* Alleghany county has 10,596 observations of 22 vars, 
* Baltimore City has 98,232 obsercations of 78 vars,
* Frederick County has 50,434 observations of 27 vars
* Howard County has 64,723 observations of 29 vars
* MoCo has 99,999 observations of 72 vars
* PG county has 99,999 observations of 76 vars
* Talbot county has 7,932 observations of 23 vars

It looks like the more rural/red(?) counties have less on their ballots and Cast Vote records. It seems like there were places with more seats on their ballots. 
One thing about this data is that there is so much of it for each county, especially
those that are more populated. To analyze our questions we would likely have to select
just a few counties for our analysis for sake of time and computing power. 
For Codes or definitions, everything seems to be straightforward, and races we are
unfamiliar with could be researched. We will probably work off of state-wide races like the Senate race and try to answer our questions based on what we have. 

* Since a lot of these school boards are non partisan for the most part, we are going
to observe the split ticketing of Republican candidates voting for or against 1776 candidates
as discussed in (this article)[https://cnsmaryland.org/2024/11/08/md-conservatives-make-gains-in-school-board-races/] and researched by us. 
```{r School Board Split Tickets}
#### Frederick #### 
table(Frederick$`Board of Education (50000167144)`)
# "Democrat" endorsed candidates: Bokee, Lowe, Monier, King Wilson Sr
# 1776 supported candidates: Colt Morningstar Black, Jaime Kiersten Brennan
# (source)[https://www.frederickdemocrats.org/md-voting/upcoming-elections/board-education]
Frederick <- Frederick |> 
  mutate(REP_BOE = case_when(
    `Board of Education (50000167144)` == "Colt Morningstar Black (10022022.0000302)" ~ "REP",
    `Board of Education (50000167144)` == "Jaime Kiersten Brennan (10022022.0000119)" ~ "REP",
    TRUE ~ "Other"
  ),
  not_split = ifelse(str_detect(`Ballot Style`, "Rep") & REP_BOE == "REP" | str_detect(`Ballot Style`, "Dem") & REP_BOE != "REP" , 1 , 0)) # if they are REP and voted for one of the 1776 ed candidates OR Dem and did NOT vote for one of the 1776 candidates, they did NOT split their PRIMARY ballot
table(Frederick$not_split) 
# 34949 not split
# 15485 split from party candidates

Frederickn_Rep <- Frederick |> 
  filter(str_detect(`Ballot Style`, "Rep"))
table(Frederick_Rep$not_split)
# 9127 Republicans split
# 11330 republicans did not split (voted for 1776 candidates)
11330/(11330+9127)*100 # 55% did not split

#### Washington #### 
table(Washington$`Board of Education (50000167344)`)
# 1776 candidates: Charles A. Burkett, Ashley McCusker, Victoria Beachley, April Ann Zentmeyer*
# "Dem" endorsed Candidates: Pieter Bickford, Stan Stouffer, Robin Merchant Spickler, Melissa Williams
# (source)[https://bluevoterguide.org/district/MD/Washington_County/21474/169]
Washington <- Washington |> 
  mutate(REP_BOE = case_when(
    `Board of Education (50000167344)` == "Charles A. Burkett (10031031.0000509)" ~ "REP",
    `Board of Education (50000167344)` == "Ashley McCusker (10031031.0000542)" ~ "REP",
    `Board of Education (50000167344)` == "Victoria Beachley (10031031.0000172)" ~ "REP",
    `Board of Education (50000167344)` == "Melissa Williams (10031031.0000656)" ~ "REP",
    TRUE ~ "Other"
  ),
  not_split = ifelse(str_detect(`Ballot Style`, "Rep") & REP_BOE == "REP" | 
                       str_detect(`Ballot Style`, "Dem") & REP_BOE != "REP" , 1 , 0)) # if they are REP and voted for one of the 1776 ed candidates OR Dem and did NOT vote for one of the 1776 candidates, they did NOT split their PRIMARY ballot
table(Washington$not_split) 
# 12965 not split
# 11545 split from party candidates

Washington_Rep <- Washington |> 
  filter(str_detect(`Ballot Style`, "Rep"))
table(Washington_Rep$not_split)
# 6737 Republicans did not split (voted for 1776 candidates) 
6737/(6737+7302)*100 # 48% Rep did not split
# 7302 Republicans did split


# conservative candidates: Joseph Marchio, Paul Harrison, Melissa Goshorn
#### Talbot #### 
table(Talbot$`Board of Education (2) (50000173444)`)
# 1776 candidates: Ann C. O'Connor, Kerry Gunshenan, Karla Wieland-Cherry

Talbot <- Talbot |> 
  mutate(REP_BOE = case_when(
    `Board of Education (2) (50000173444)` == "Ann C. O'Connor (10122127.0000735)" ~ "REP",
    TRUE ~ "Other"
  ),
  not_split = ifelse(str_detect(`Ballot Style`, "Rep") & REP_BOE == "REP" | 
                       str_detect(`Ballot Style`, "Dem") & REP_BOE != "REP" , 1 , 0)) # if they are REP and voted for one of the 1776 ed candidates OR Dem and did NOT vote for one of the 1776 candidates, they did NOT split their PRIMARY ballot
table(Talbot$not_split) 
# 4077 not split
# 3855 split from party candidates

Talbot_Rep <- Talbot |> 
  filter(str_detect(`Ballot Style`, "Rep"))
table(Talbot_Rep$not_split)
# 239 Republicans did not split (voted for 1776 candidates) 
239/(239+3701)*100 # 6% Rep did not split
# 3701 Republicans did split

#### Anne Arundel #### 

# Conservative, not 1776 candidates: Chuck Yocum, Latoya Nkongolo, Dawn Pullium
# (source)[https://www.somdnews.com/news/state/conservative-pac-dems-face-off-over-maryland-school-board-races/article_084d9d36-9537-11ef-9d33-03374e9ddf74.html] 
table(AnneArundel$`Board of Education (1) (50000176644)`)
table(AnneArundel$`Board of Education (3) (50000173844)`) # Yocum
table(AnneArundel$`Board of Education (4) (50000176744)`)
table(AnneArundel$`Board of Education (5) (50000176844)`) # Latoya

AnneArundel <- AnneArundel |> 
  mutate(REP_BOE = case_when(
    `Board of Education (3) (50000173844)` == "Chuck Yocum (10024024.0000151)" ~ "REP",
    `Board of Education (5) (50000176844)` == "LaToya Nkongolo (10008008.0000078)" ~ "REP",
    TRUE ~ "Other"
  ),
  not_split = ifelse(str_detect(`Ballot Style`, "Rep") & REP_BOE == "REP" | 
                       str_detect(`Ballot Style`, "Dem") & REP_BOE != "REP" , 1 , 0)) # if they are REP and voted for one of the 1776 ed candidates OR Dem and did NOT vote for one of the 1776 candidates, they did NOT split their PRIMARY ballot
table(AnneArundel$not_split) 
# 55953 not split
# 37613 split from party candidates

AnneArundel_Rep <- AnneArundel |> 
  filter(str_detect(`Ballot Style`, "Rep"))
table(AnneArundel_Rep$not_split)
# 3903 Republicans did not split (voted for 1776 candidates) 
3903/(3903+31555)*100 # 11% Rep did not split
# 31555 Republicans did split
```

