---
title: "Data_Analysis_Project"
author: "Isabelle Jensen, Sonia Vargas"
date: "11/16/24"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
This project explores cast vote records (CVRs) from the Maryland 2024 primary elections to uncover trends, patterns, and insights into voter behavior. By examining these detailed voting records, we aim to answer several newsworthy questions about the electoral process, such as straight-ticket voting rates, undervoting in down-ballot races, and the influence of ballot styles on voter choices.

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(janitor)
library(lubridate)
library(dplyr)
library(readxl)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary 
for data you are working with, and discuss any caveats or issues you discovered 
working with this data. 

This data is pretty huge, but this is a collection of all of the data if we were to want to load all of them.

```{r}
Alleghany <- read_excel("data/01_Allegany PP24 CVRs/01PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Alleghany")
AnneArundel <- read_excel("data/02_Anne Arundel PP24 CVRs/02PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Anne Arundel")
BaltimoreCity <- read_excel("data/03_Baltimore City PP24 CVRs/03PP24_Prov_CVR_SBE.xlsx") |>  
  mutate(County = "Baltimore City")
BaltimoreCounty <- read_excel("data/04_Baltimore County PP24 CVRs/04PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Baltimore County")
Calvert <- read_excel("data/05_Calvert PP24 CVRs/05PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Calvert")
Caroline <- read_excel("data/06_Caroline PP24 CVRs/06PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Caroline")
Carroll <- read_excel("data/07_Carroll PP24 CVRs/07PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Carroll")
Cecil <- read_excel("data/08_Cecil PP24 CVRs/08PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Cecil")
Charles <- read_excel("data/09_Charles PP24 CVRs/09PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Charles")
Dorchester <- read_excel("data/10_Dorchester PP24 CVRs/10PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Dorchester")
Frederick <- read_excel("data/11_Frederick PP24 CVRs/11PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Frederick")
Garrett <- read_excel("data/12_Garrett PP24 CVRs/12PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Garrett")
Harford <- read_excel("data/13_Harford PP24 CVRs/13PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Harford")
Howard <- read_excel("data/14_Howard PP24 CVRs/14PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Howard")
Kent <- read_excel("data/15_Kent PP24 CVRs/15PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Kent")
Montgomery <- read_excel("data/16_Montgomery PP24 CVRs/16PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Montgomery")
PG <- read_excel("data/17_Prince George's PP24 CVRs/17PP24_Prov_CVR_SBE.xlsx") |>
  mutate(County = "Prince George's")
QueenAnnes <- read_excel("data/18_Queen Annes PP24 CVRs/18PP24_Prov_CVR_SBE.xlsx") |>
  mutate(County = "Queen Anne's")
StMarys <- read_excel("data/19_St Marys PP24 CVRs/19PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "St Marys")
Somerset <- read_excel("data/20_Somerset PP24 CVRs/20PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Somerset")
Talbot <- read_excel("data/21_Talbot PP24 CVRs/21PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Talbot")
Washington <- read_excel("data/22_Washington PP24 CVRs/22PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Washington")
Wicomico <- read_excel("data/23_Wicomico PP24 CVRs/23PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Wicomico")
Worcester <- read_excel("data/24_Worcester PP24 CVRs/24PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Worcester")
  
```

## Questions to explore
1. What is the proportion of Straight-Ticket Voting?
2. What are the Undervoting Rates in Down-Ballot Races?
3. Are there certain Precincts that behave similarly due to some aspects?
4. How much Ballot Splitting can we see in the cast vote records?
5. What is the Impact of Ballot Style on Voting Patterns in Local Races?

## Deliverable 2 (week 12) - 10 percent: 
For a quick overlook of a few interesting counties in MD: 
* Alleghany county has 10,596 observations of 22 vars, 
* Baltimore City has 98,232 obsercations of 78 vars,
* Frederick County has 50,434 observations of 27 vars
* Howard County has 64,723 observations of 29 vars
* MoCo has 99,999 observations of 72 vars
* PG county has 99,999 observations of 76 vars
* Talbot county has 7,932 observations of 23 vars

It looks like the more rural/red(?) counties have less on their ballots and Cast Vote records. It seems like there were places with more seats on their ballots. 
One thing about this data is that there is so much of it for each county, especially
those that are more populated. To analyze our questions we would likely have to select
just a few counties for our analysis for sake of time and computing power. 
For Codes or definitions, everything seems to be straightforward, and races we are
unfamiliar with could be researched. We will probably work off of state-wide races like the Senate race and try to answer our questions based on what we have. 

* Since a lot of these school boards are non partisan for the most part, we are going
to observe the split ticketing of Republican candidates voting for or against 1776 candidates
as discussed in (this article)[https://cnsmaryland.org/2024/11/08/md-conservatives-make-gains-in-school-board-races/] and researched by us. 
```{r School Board Split Tickets}
#### Frederick #### 
table(Frederick$`Board of Education (50000167144)`)
# "Democrat" endorsed candidates: Bokee, Lowe, Monier, King Wilson Sr
# 1776 supported candidates: Colt Morningstar Black, Jaime Kiersten Brennan
# (source)[https://www.frederickdemocrats.org/md-voting/upcoming-elections/board-education]
Frederick <- Frederick |> 
  mutate(REP_BOE = case_when(
    `Board of Education (50000167144)` == "Colt Morningstar Black (10022022.0000302)" ~ "REP",
    `Board of Education (50000167144)` == "Jaime Kiersten Brennan (10022022.0000119)" ~ "REP",
    TRUE ~ "Other"
  ),
  not_split = ifelse(str_detect(`Ballot Style`, "Rep") & REP_BOE == "REP" | str_detect(`Ballot Style`, "Dem") & REP_BOE != "REP" , 1 , 0)) # if they are REP and voted for one of the 1776 ed candidates OR Dem and did NOT vote for one of the 1776 candidates, they did NOT split their PRIMARY ballot
table(Frederick$not_split) 
# 34949 not split
# 15485 split from party candidates

Frederick_Rep <- Frederick |> 
  filter(str_detect(`Ballot Style`, "Rep"))
table(Frederick_Rep$not_split)
# 9127 Republicans split
# 11330 republicans did not split (voted for 1776 candidates)
11330/(11330+9127)*100 # 55% did not split

#### Washington #### 
table(Washington$`Board of Education (50000167344)`)
# 1776 candidates: Charles A. Burkett, Ashley McCusker, Victoria Beachley, April Ann Zentmeyer*
# "Dem" endorsed Candidates: Pieter Bickford, Stan Stouffer, Robin Merchant Spickler, Melissa Williams
# (source)[https://bluevoterguide.org/district/MD/Washington_County/21474/169]
Washington <- Washington |> 
  mutate(REP_BOE = case_when(
    `Board of Education (50000167344)` == "Charles A. Burkett (10031031.0000509)" ~ "REP",
    `Board of Education (50000167344)` == "Ashley McCusker (10031031.0000542)" ~ "REP",
    `Board of Education (50000167344)` == "Victoria Beachley (10031031.0000172)" ~ "REP",
    `Board of Education (50000167344)` == "Melissa Williams (10031031.0000656)" ~ "REP",
    TRUE ~ "Other"
  ),
  not_split = ifelse(str_detect(`Ballot Style`, "Rep") & REP_BOE == "REP" | 
                       str_detect(`Ballot Style`, "Dem") & REP_BOE != "REP" , 1 , 0)) # if they are REP and voted for one of the 1776 ed candidates OR Dem and did NOT vote for one of the 1776 candidates, they did NOT split their PRIMARY ballot
table(Washington$not_split) 
# 12965 not split
# 11545 split from party candidates

Washington_Rep <- Washington |> 
  filter(str_detect(`Ballot Style`, "Rep"))
table(Washington_Rep$not_split)
# 6737 Republicans did not split (voted for 1776 candidates) 
6737/(6737+7302)*100 # 48% Rep did not split
# 7302 Republicans did split


# conservative candidates: Joseph Marchio, Paul Harrison, Melissa Goshorn
#### Talbot #### 
table(Talbot$`Board of Education (2) (50000173444)`)
# 1776 candidates: Ann C. O'Connor, Kerry Gunshenan, Karla Wieland-Cherry

Talbot <- Talbot |> 
  mutate(REP_BOE = case_when(
    `Board of Education (2) (50000173444)` == "Ann C. O'Connor (10122127.0000735)" ~ "REP",
    TRUE ~ "Other"
  ),
  not_split = ifelse(str_detect(`Ballot Style`, "Rep") & REP_BOE == "REP" | 
                       str_detect(`Ballot Style`, "Dem") & REP_BOE != "REP" , 1 , 0)) # if they are REP and voted for one of the 1776 ed candidates OR Dem and did NOT vote for one of the 1776 candidates, they did NOT split their PRIMARY ballot
table(Talbot$not_split) 
# 4077 not split
# 3855 split from party candidates

Talbot_Rep <- Talbot |> 
  filter(str_detect(`Ballot Style`, "Rep"))
table(Talbot_Rep$not_split)
# 239 Republicans did not split (voted for 1776 candidates) 
239/(239+3701)*100 # 6% Rep did not split
# 3701 Republicans did split

#### Anne Arundel #### 

# Conservative, not 1776 candidates: Chuck Yocum, Latoya Nkongolo, Dawn Pullium
# (source)[https://www.somdnews.com/news/state/conservative-pac-dems-face-off-over-maryland-school-board-races/article_084d9d36-9537-11ef-9d33-03374e9ddf74.html] 
table(AnneArundel$`Board of Education (1) (50000176644)`)
table(AnneArundel$`Board of Education (3) (50000173844)`) # Yocum
table(AnneArundel$`Board of Education (4) (50000176744)`)
table(AnneArundel$`Board of Education (5) (50000176844)`) # Latoya

AnneArundel <- AnneArundel |> 
  mutate(REP_BOE = case_when(
    `Board of Education (3) (50000173844)` == "Chuck Yocum (10024024.0000151)" ~ "REP",
    `Board of Education (5) (50000176844)` == "LaToya Nkongolo (10008008.0000078)" ~ "REP",
    TRUE ~ "Other"
  ),
  not_split = ifelse(str_detect(`Ballot Style`, "Rep") & REP_BOE == "REP" | 
                       str_detect(`Ballot Style`, "Dem") & REP_BOE != "REP" , 1 , 0)) # if they are REP and voted for one of the 1776 ed candidates OR Dem and did NOT vote for one of the 1776 candidates, they did NOT split their PRIMARY ballot
table(AnneArundel$not_split) 
# 55953 not split
# 37613 split from party candidates

AnneArundel_Rep <- AnneArundel |> 
  filter(str_detect(`Ballot Style`, "Rep"))
table(AnneArundel_Rep$not_split)
# 3903 Republicans did not split (voted for 1776 candidates) 
3903/(3903+31555)*100 # 11% Rep did not split
# 31555 Republicans did split
```
```{r, BOE Maps by Precinct}
# Load libraries
library(sf)
library(janitor)
library(tidycensus)
library(ggplot2)
library(cowplot)
library(tigris)

# Counties I am working with: Anne Arundel, Frederick, Talbot, Washington
# Counties that appear to also have had right wing PAC supported candidates: Cecil

# Trying to code a sub data set organized by precinct within each county
# Rep_Rep = republicans that voted for the rep supported candidates
# Rep_Split = republicans that did not vote for the right wing candidates
# Dem_Dem = dems that did not vote for the right wing candidates
# Dem_Split = dems that did vote for the right wing candidates

AnneArundel <- AnneArundel |> 
  # lets simplify the party ballot var structure
  mutate(Ballot_party = case_when(
      (str_detect(`Ballot Style`, "Rep")) ~ "Rep",
      (str_detect(`Ballot Style`, "Dem")) ~ "Dem",
      TRUE ~ "Other"))

AnneArundel <- AnneArundel |> 
  # lets make the breakdown of split or not split by party
  mutate(split = case_when(
      Ballot_party == "Rep" & REP_BOE == "REP"  ~ "Rep_Rep",
      Ballot_party == "Dem" & REP_BOE != "REP" ~ "Dem_Dem",
      Ballot_party == "Rep" & REP_BOE != "REP"  ~ "Rep_Split",
      Ballot_party == "Dem" & REP_BOE == "REP" ~ "Dem_Split",
      TRUE ~ "Other"
      ))

New_AnneArundel <- AnneArundel |>
  filter(split != "Other") |> # this is so we are only looking at partisan ballots and percentages
  filter(str_detect(Precinct, "003-") | str_detect(Precinct, "005-")) |>  # these are the only two districts that had BOE elections
  mutate(PRECINCT = str_sub(Precinct, 1, 3))

# Now a table of splits, party counts, by precinct
AA1 <- New_AnneArundel |>  
 group_by(Precinct) |> 
    summarise(Dem_count = sum(Ballot_party == "Dem"),
              Rep_count = sum(Ballot_party == "Rep"),
              Rep_split = sum(split == "Rep_Split"),
              Dem_split = sum(split == "Dem_Split"),
              total_split = Rep_split + Dem_split,
              n = n(),
              total_split_PCT = total_split/n*100,
              Dem_split_PCT = Dem_split/Dem_count*100,
              Rep_split_PCT = Rep_split/Rep_count*100
              )

counties <- counties()
glimpse(counties)
md_counties <- counties |>
  filter(STATEFP == "24")

AA_precincts <- read_sf("data/Voter_Precincts.shp")
AA_precincts |>
  ggplot() +
  geom_sf() +
  theme_minimal()

AA1_Precincts <- AA1 |> 
  left_join(AA_precincts, by = ("PRECINCT"))
```


Undervote Coding

Montgomery

```{r}

glimpse(Montgomery)


Montgomery |>
  filter(
    `DEM President of the United States (4) (500001630104)` == "undervote" |
    `DEM President of the United States (6) (500001630106)` == "undervote" |
    `DEM President of the United States (8) (500001630108)` == "undervote"
  ) |>
  summarize(
    `Race 4` = sum(`DEM President of the United States (4) (500001630104)` == "undervote", na.rm = TRUE),
    `Race 6` = sum(`DEM President of the United States (6) (500001630106)` == "undervote", na.rm = TRUE),
    `Race 8` = sum(`DEM President of the United States (8) (500001630108)` == "undervote", na.rm = TRUE)
  )
5 +	61+	269	
#335 undervotes for president

Montgomery |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (4) (500001630104)`)),
    `Total DEM (6)` = sum(!is.na(`DEM President of the United States (6) (500001630106)`)),
    `Total DEM (8)` = sum(!is.na(`DEM President of the United States (8) (500001630108)`))
  )
2329 + 12548 + 62687
#77564

335/77564
#0.4% of all democratic presidential votes were undervotes


Montgomery |>
  filter(
    `REP President of the United States (4) (500001630204)` == "undervote" |
    `REP President of the United States (6) (500001630206)` == "undervote" |
    `REP President of the United States (8) (500001630208)` == "undervote"
  ) |>
  summarize(
    `REP Race 4` = sum(`REP President of the United States (4) (500001630204)` == "undervote", na.rm = TRUE),
    `REP Race 6` = sum(`REP President of the United States (6) (500001630206)` == "undervote", na.rm = TRUE),
    `REP Race 8` = sum(`REP President of the United States (8) (500001630208)` == "undervote", na.rm = TRUE)
  )
13	+0 +	348
#361 undervotes for Rep pres

Montgomery |>
  summarize(
    `Total REP (4)` = sum(!is.na(`REP President of the United States (4) (500001630204)`)),
    `Total REP (6)` = sum(!is.na(`REP President of the United States (6) (500001630206)`)),
    `Total REP (8)` = sum(!is.na(`REP President of the United States (8) (500001630208)`))
  )

435+0 +11988

361/12423
#2.9% undervotes for Rep president out of total votes


Montgomery |>
  filter(
    `DEM U.S. Senator (5000017641)` == "undervote" )|>
  summarize(
    Total = sum(`DEM U.S. Senator (5000017641)`  == "undervote", na.rm = TRUE),
  )
#897 senate dem undervotes

Montgomery |>
  summarize(
    totalvotes=sum(!is.na(`DEM U.S. Senator (5000017641)` )))
#Total senate dem votes 77564	

897/77564	
#1.2% undervote


Montgomery |>
  filter(
    `REP U.S. Senator (5000017642)` == "undervote" )|>
  summarize(
    Total = sum(`REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE),
  )
#306 senate rep undervotes

Montgomery |>
  summarize(
    totalvotes=sum(!is.na(`REP U.S. Senator (5000017642)` )))
#Total senate rep votes 16976		


306/16976
#1.8% of all senate rep votes were undervotes




undervotes_df <- tibble(
  County = character(),
  DEM_President_Undervotes = numeric(),
  DEM_President_Percentage = numeric(),
  REP_President_Undervotes = numeric(),
  REP_President_Percentage = numeric(),
  DEM_Senate_Undervotes = numeric(),
  DEM_Senate_Percentage = numeric(),
  REP_Senate_Undervotes = numeric(),
  REP_Senate_Percentage = numeric()
)

# Add Montgomery County results manually
montgomery_results <- tibble(
  County = "Montgomery",
  DEM_President_Undervotes = 335,
  DEM_President_Percentage = 335 / 77564 * 100,  
  REP_President_Undervotes = 361,
  REP_President_Percentage = 361 / 12423 * 100,  
  DEM_Senate_Undervotes = 897,
  DEM_Senate_Percentage = 897 / 77564 * 100,   
  REP_Senate_Undervotes = 306,
  REP_Senate_Percentage = 306 / 16976 * 100, 
  Total_REP_Votes = 12423,  
  Total_DEM_Votes = 77564, 
   Percent_DEM_of_Total = 77564 / (77564 + 12423) * 100 
)

# Append to the DataFrame
undervotes_df <- bind_rows(undervotes_df, montgomery_results)

undervotes_df




#undervotes_df <- undervotes_df %>%
 # filter(County != "Montgomery")

```

Undervote Howard

```{r}

glimpse(Howard)


Howard |>
  filter(
    `DEM President of the United States (3) (500001630103)`  == "undervote" ) |>
  summarize(
    Count = sum(`DEM President of the United States (3) (500001630103)`  == "undervote", na.rm = TRUE)
  )
#231 undervotes for president

Howard |>
  summarize(
    Count = sum(!is.na( `DEM President of the United States (3) (500001630103)`))
  )
#44726	total dem pres votes

231/44726
#0.5% of all democratic presidential votes were undervotes


Howard |>
  filter(
    `REP President of the United States (3) (500001630203)`   == "undervote" ) |>
  summarize(
    Count = sum(`REP President of the United States (3) (500001630203)`   == "undervote", na.rm = TRUE)
  )
#512 undervotes for president

Howard |>
  summarize(
    Count = sum(!is.na(  `REP President of the United States (3) (500001630203)` ))
  )
#15901

512/15901
#3.2% undervote for president rep candidates


Howard |>
  filter(
   `DEM U.S. Senator (5000017641)`  == "undervote" ) |>
  summarize(
    Count = sum(`DEM U.S. Senator (5000017641)`  == "undervote", na.rm = TRUE)
  )
#967 undervotes for senate

Howard |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`))
  )
#44726	

927/44726
#2.1% undervote democrate senate race


Howard |>
  filter(
   `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum(`REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#261	 undervotes for senate

Howard |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#15901		

261/15901
#1.6% undervotes for rep senate


undervotes_df <- tibble(
  County = character(),
  DEM_President_Undervotes = numeric(),
  DEM_President_Percentage = numeric(),
  REP_President_Undervotes = numeric(),
  REP_President_Percentage = numeric(),
  DEM_Senate_Undervotes = numeric(),
  DEM_Senate_Percentage = numeric(),
  REP_Senate_Undervotes = numeric(),
  REP_Senate_Percentage = numeric()
)

# Add Montgomery County results manually
Howard_results <- tibble(
  County = "Howard",
  DEM_President_Undervotes = 231,
  DEM_President_Percentage = 231 / 44726 * 100,  
  REP_President_Undervotes = 512,
  REP_President_Percentage = 512 / 15901 * 100,  
  DEM_Senate_Undervotes = 967,
  DEM_Senate_Percentage = 967 / 44726 * 100,    
  REP_Senate_Undervotes = 261,
  REP_Senate_Percentage = 261 / 15901 * 100,
  Total_REP_Votes = 15901,  
  Total_DEM_Votes = 44726, 
  Percent_DEM_of_Total = 44726 / (44726 + 15901) * 100  

)

# Append to the DataFrame
undervotes_df <- bind_rows(undervotes_df, Howard_results)
undervotes_df


```





Frederick Undervotes
```{r}
glimpse(Frederick)


Frederick |>
  filter(
    `DEM President of the United States (6) (500001630106)`   == "undervote" ) |>
  summarize(
    Count = sum( `DEM President of the United States (6) (500001630106)`   == "undervote", na.rm = TRUE)
  )
#168 undervotes for president

Frederick |>
  summarize(
    Count = sum(!is.na(  `DEM President of the United States (6) (500001630106)` ))
  )
#25772		total dem pres votes

168/25772
#0.6% of all democratic presidential votes were undervotes


Frederick |>
  filter(
   `REP President of the United States (6) (500001630206)`    == "undervote" ) |>
  summarize(
    Count = sum( `REP President of the United States (6) (500001630206)`    == "undervote", na.rm = TRUE)
  )
#491 undervotes for president

Frederick |>
  summarize(
    Count = sum(!is.na(  `REP President of the United States (6) (500001630206)`  ))
  )
#20457		total rep pres votes

491/20457
#2.4% of all republican presidential votes were undervotes


Frederick |>
  filter(
   `DEM U.S. Senator (5000017641)`   == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#471 undervotes for senates

Frederick |>
  summarize(
    Count = sum(!is.na(  `DEM U.S. Senator (5000017641)`  ))
  )
#25772	total dem senate votes

471/25772
#1.8% of all democratic senate votes were undervotes


Frederick |>
  filter(
   `REP U.S. Senator (5000017642)`      == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`      == "undervote", na.rm = TRUE)
  )
#442	 undervotes for senate

Frederick |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`    ))
  )
#20457		total rep sebate votes

442/20457
#2.2% of all republican senate votes were undervotes

undervotes_df <- data.frame(
  County = character(),
  DEM_President_Undervotes = numeric(),
  DEM_President_Percentage = numeric(),
  REP_President_Undervotes = numeric(),
  REP_President_Percentage = numeric(),
  DEM_Senate_Undervotes = numeric(),
  DEM_Senate_Percentage = numeric(),
  REP_Senate_Undervotes = numeric(),
  REP_Senate_Percentage = numeric(),
  stringsAsFactors = FALSE 
)

Frederick_results <- data.frame(
  County = "Frederick",
  DEM_President_Undervotes = 168,
  DEM_President_Percentage = 168 / 25772 * 100,
  REP_President_Undervotes = 491,
  REP_President_Percentage = 491 / 20457 * 100,  
  DEM_Senate_Undervotes = 471,
  DEM_Senate_Percentage = 471 / 25772 * 100,    
  REP_Senate_Undervotes = 442,
  REP_Senate_Percentage = 442 / 20457 * 100,     
  Total_REP_Votes = 20457,  
  Total_DEM_Votes = 25772, 
  Percent_DEM_of_Total = 25772 / (25772 + 20457) * 100,
  stringsAsFactors = FALSE
)

undervotes_df <- rbind(undervotes_df, Frederick_results)


print(undervotes_df)


undervotes_df <- undervotes_df %>%
  select(-Vote_Difference)

```




Baltimore City Undervotes
```{r}

glimpse(BaltimoreCity)


BaltimoreCity |>
  filter(
    `DEM President of the United States (2) (500001630102)` == "undervote" |
    `DEM President of the United States (7) (500001630107)`    == "undervote" ) |>
  summarize(
    `Race 2` = sum( `DEM President of the United States (2) (500001630102)` == "undervote", na.rm = TRUE),
    `Race 7` = sum( `DEM President of the United States (7) (500001630107)`  == "undervote", na.rm = TRUE)
  )
57+	1146	
#1203 undervotes for dem president

BaltimoreCity |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (2) (500001630102)`)),
    `Total DEM (7)` = sum(!is.na(`DEM President of the United States (7) (500001630107)` ))
  )
8430+	85254
# 93684

1203/93684
#1.3% of all democratic presidential votes were undervotes




BaltimoreCity |>
  filter(
   `REP President of the United States (2) (500001630202)` == "undervote" |
    `REP President of the United States (7) (500001630207)`    == "undervote" ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (2) (500001630202)` == "undervote", na.rm = TRUE),
    `Race 7` = sum( `REP President of the United States (7) (500001630207)`  == "undervote", na.rm = TRUE)
  )
0	+175		
#175 undervotes for rep president

BaltimoreCity |>
  summarize(
    `Total REP (2)` = sum(!is.na(`REP President of the United States (2) (500001630202)`)),
    `Total REP (7)` = sum(!is.na(`REP President of the United States (7) (500001630207)` ))
  )
0	+4090

# 4090
175/4090
#4.3% of all republican presidential votes were undervotes




BaltimoreCity |>
  filter(
  `DEM U.S. Senator (5000017641)`   == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#3088 undervotes for senates

BaltimoreCity |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`  ))
  )
#93684	total dem senate votes

3088/93684
#3.3% of all democratic senate votes were undervotes


BaltimoreCity |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`   == "undervote", na.rm = TRUE)
  )
#157 undervotes for rep senate

BaltimoreCity |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)` ))
  )
#4548		total rep senate votes

157/4548
#3.5% of all republican senate votes were undervotes

BaltimoreCity_results <- data.frame(
  County = "Baltimore City",
  DEM_President_Undervotes = 1203,
  DEM_President_Percentage = 1203 / 93684 * 100,  # Calculated manually
  REP_President_Undervotes = 175,
  REP_President_Percentage = 175 / 4090 * 100,  # Calculated manually
  DEM_Senate_Undervotes = 3088,
  DEM_Senate_Percentage = 3088 / 93684 * 100,    # Calculated manually
  REP_Senate_Undervotes = 157,
  REP_Senate_Percentage = 157 / 4548 * 100,     # Calculated manually
  Total_REP_Votes = 4090,  
  Total_DEM_Votes = 93684, 
  Percent_DEM_of_Total = 93684 / (93684 + 4090) * 100,
  stringsAsFactors = FALSE
)

# Append to the data frame
undervotes_df <- rbind(undervotes_df, BaltimoreCity_results)

undervotes_df


```




Undervotes Baltimore County
```{r}

glimpse(BaltimoreCounty)


BaltimoreCounty |>
  filter(
    `DEM President of the United States (1) (500001630101)` == "undervote" |
   `DEM President of the United States (2) (500001630102)`  == "undervote" |
   `DEM President of the United States (7) (500001630107)`   == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (1) (500001630101)` == "undervote", na.rm = TRUE),
    `Race 2` = sum( `DEM President of the United States (2) (500001630102)` == "undervote", na.rm = TRUE),
    `Race 7` = sum(`DEM President of the United States (7) (500001630107)` == "undervote", na.rm = TRUE)
  )
18+	243+	70	
#331 undervotes for president

BaltimoreCounty |>
  summarize(
    `Total DEM (1)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`)),
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (2) (500001630102)`)),
    `Total DEM (7)` = sum(!is.na(`DEM President of the United States (7) (500001630107)`))
  )
3565	+48222	+15297
#67084

331/67084
#0.5 percent of all dem votes for president were undervotes


BaltimoreCounty |>
  filter(
   `REP President of the United States (1) (500001630201)`  == "undervote" |
  `REP President of the United States (2) (500001630202)`    == "undervote" |
   `REP President of the United States (7) (500001630207)`      == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `REP President of the United States (1) (500001630201)`  == "undervote", na.rm = TRUE),
    `Race 2` = sum( `REP President of the United States (2) (500001630202)`   == "undervote", na.rm = TRUE),
    `Race 7` = sum(`REP President of the United States (7) (500001630207)`    == "undervote", na.rm = TRUE)
  )
0+	471	+72	
#543 undervotes for president

BaltimoreCounty |>
  summarize(
    `Total rep (1)` = sum(!is.na(`REP President of the United States (1) (500001630201)` )),
    `Total rep (2)` = sum(!is.na(`REP President of the United States (2) (500001630202)`  )),
    `Total rep (7)` = sum(!is.na(`REP President of the United States (7) (500001630207)` ))
  )

0	+21924 +5837
#27761

543/27761
#2% of all votes for rep president was an undervote



BaltimoreCounty |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#1107 undervotes for senates

BaltimoreCounty |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#67084	total dem senate votes

1107/67084
#1.7% of all democratic senate votes were undervotes



BaltimoreCounty |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#530	 undervotes for rep senate

BaltimoreCounty |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#32915		total rep senate votes

530/32915
#1.6% of all republican senate votes were undervotes

BaltimoreCounty_results <- data.frame(
  County = "Baltimore County",
  DEM_President_Undervotes = 331,
  DEM_President_Percentage = 331 / 67084 * 100,  # Calculated manually
  REP_President_Undervotes = 543,
  REP_President_Percentage = 543 / 27761 * 100, 
  DEM_Senate_Undervotes = 1107,
  DEM_Senate_Percentage = 1107 / 67084 * 100,    
  REP_Senate_Undervotes = 530,
  REP_Senate_Percentage = 530 / 32915 * 100,    
  Total_REP_Votes = 27761,  
  Total_DEM_Votes = 67084, 
  Percent_DEM_of_Total = 67084 / (67084 + 27761) * 100,
  stringsAsFactors = FALSE
)

# Append to the data frame
undervotes_df <- rbind(undervotes_df, BaltimoreCounty_results)

undervotes_df




```

Undervote Alleghany
```{r}
glimpse(Alleghany)

Alleghany |>
  filter(
   `DEM President of the United States (6) (500001630106)` == "undervote" 
  ) |>
  summarize(
    `Race 1` = sum(`DEM President of the United States (6) (500001630106)` == "undervote", na.rm = TRUE),
  )
#34 undervotes for dem president

Alleghany |>
  summarize(
    `Total DEM (1)` = sum(!is.na(`DEM President of the United States (6) (500001630106)`))
  )
#3394	total dem pres votes

Alleghany |>
  filter(
  `REP President of the United States (6) (500001630206)`   == "undervote" 
  ) |>
  summarize(
    `Race 1` = sum( `REP President of the United States (6) (500001630206)`   == "undervote", na.rm = TRUE))
#126 undervotes for rep president

Alleghany |>
  summarize(
    `Total rep (1)` = sum(!is.na(`REP President of the United States (6) (500001630206)`))
  )


#7202 total rep primary votes


Alleghany |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#80 undervotes for dem senates

Alleghany |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#3394	total dem senate votes

Alleghany |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#194	 undervotes for rep senate

Alleghany |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#7202		total rep senate votes


Alleghany_results <- data.frame(
  County = "Alleghany",
  DEM_President_Undervotes = 34,
  DEM_President_Percentage = 34 / 3394 * 100,  # Calculated manually
  REP_President_Undervotes = 126,
  REP_President_Percentage = 126 / 7202 * 100,  # Calculated manually
  DEM_Senate_Undervotes = 80,
  DEM_Senate_Percentage = 80 / 3394 * 100,    # Calculated manually
  REP_Senate_Undervotes = 194,
  REP_Senate_Percentage = 194 / 7202 * 100,     # Calculated manually
  Total_REP_Votes = 7202,  
  Total_DEM_Votes = 3394, 
  Percent_DEM_of_Total = 3394 / (3394 + 7202) * 100,
  stringsAsFactors = FALSE
)

# Append to the data frame
undervotes_df <- rbind(undervotes_df, Alleghany_results)

undervotes_df


```

AnneArundel undervote
```{r}
glimpse(AnneArundel)

AnneArundel |>
  filter(
   `DEM President of the United States (3) (500001630103)` == "undervote" |
    `DEM President of the United States (5) (500001630105)`   == "undervote"
  ) |>
  summarize(
    `Race 1` = sum(`DEM President of the United States (3) (500001630103)` == "undervote", na.rm = TRUE),
    `Race 2` = sum(`DEM President of the United States (5) (500001630105)` == "undervote", na.rm = TRUE)
  )
176	+57
#233 undervotes for dem president

AnneArundel |>
  summarize(
    `Total DEM (1)` = sum(!is.na(`DEM President of the United States (3) (500001630103)`)),
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (5) (500001630105)`))
  )
38860	+15897	
#54757	total dem pres votes

AnneArundel |>
  filter(
  `REP President of the United States (3) (500001630203)`   == "undervote" |
    `REP President of the United States (5) (500001630205)`   == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `REP President of the United States (3) (500001630203)`  == "undervote", na.rm = TRUE),
    `Race 2` = sum( `REP President of the United States (5) (500001630205)`     == "undervote", na.rm = TRUE))
654	+249	
#903 undervotes for rep president

AnneArundel |>
  summarize(
    `Total rep (1)` = sum(!is.na( `REP President of the United States (3) (500001630203)`)),
       `Total rep (2)` = sum(!is.na(`REP President of the United States (5) (500001630205)`))
  )

26021	+9437	
#35458 total rep primary votes


AnneArundel |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#1145 undervotes for dem senates

AnneArundel |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#54757	total dem senate votes

AnneArundel |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#575	 undervotes for rep senate

AnneArundel |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#35458		total rep senate votes


AnneArundel_results <- data.frame(
  County = "Anne Arundel",
  DEM_President_Undervotes = 233,
  DEM_President_Percentage = 233 / 54757 * 100,
  REP_President_Undervotes = 903,
  REP_President_Percentage = 903 / 35458 * 100, 
  DEM_Senate_Undervotes = 1145,
  DEM_Senate_Percentage = 1145 / 54757 * 100, 
  REP_Senate_Undervotes = 575,
  REP_Senate_Percentage = 575 / 35458 * 100,     
  Total_REP_Votes = 35458,  
  Total_DEM_Votes = 3394, 
  Percent_DEM_of_Total = 54757 / (54757 + 35458) * 100,
  stringsAsFactors = FALSE
)

# Append to the data frame
undervotes_df <- rbind(undervotes_df, AnneArundel_results)

undervotes_df






```
Calvert Undervote
```{r}
glimpse(Calvert)

Calvert |>
  filter(
    `DEM President of the United States (5) (500001630105)`   == "undervote"
  ) |>
  summarize(
    `Race 2` = sum(`DEM President of the United States (5) (500001630105)` == "undervote", na.rm = TRUE)
  )
#59 undervotes for dem president

Calvert |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (5) (500001630105)`))
  )
#8005	total dem pres votes

Calvert |>
  filter(
    `REP President of the United States (5) (500001630205)`   == "undervote"
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (5) (500001630205)`     == "undervote", na.rm = TRUE))
#185 undervotes for rep president

Calvert |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (5) (500001630205)`))
  )

#9211 total rep primary votes


Calvert |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#247 undervotes for dem senates

Calvert |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#8005	total dem senate votes

Calvert |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#213	 undervotes for rep senate

Calvert |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#9211		total rep senate votes


Calvert_results <- data.frame(
  County = "Calvert",
  DEM_President_Undervotes = 59,
  DEM_President_Percentage = 59 / 8005 * 100,  
  REP_President_Undervotes = 185,
  REP_President_Percentage = 185 / 9211 * 100, 
  DEM_Senate_Undervotes = 247,
  DEM_Senate_Percentage = 247 / 8005 * 100,    
  REP_Senate_Undervotes = 213,
  REP_Senate_Percentage = 213 / 9211 * 100,     
  Total_REP_Votes = 9211,  
  Total_DEM_Votes = 8005, 
  Percent_DEM_of_Total = 8005 / (8005 + 9211) * 100,
  stringsAsFactors = FALSE
)

# Append to the data frame
undervotes_df <- rbind(undervotes_df, Calvert_results)

undervotes_df




```


Caroline Undervote
```{r}
glimpse(Caroline)

Caroline |>
  filter(
    `DEM President of the United States (1) (500001630101)`     == "undervote"
  ) |>
  summarize(
    `Race 2` = sum(`DEM President of the United States (1) (500001630101)`   == "undervote", na.rm = TRUE)
  )
#8	undervotes for dem president

Caroline |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`  ))
  )
#1351	total dem pres votes

Caroline |>
  filter(
   `REP President of the United States (1) (500001630201)`       == "undervote"
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (1) (500001630201)`         == "undervote", na.rm = TRUE))
#41	 undervotes for rep president

Caroline |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (1) (500001630201)`  ))
  )

#2651 total rep primary votes


Caroline |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#39 undervotes for dem senates

Caroline |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#1351	total dem senate votes

Caroline |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#40	 undervotes for rep senate

Caroline |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#2651		total rep senate votes


Caroline_results <- data.frame(
  County = "Caroline",
  DEM_President_Undervotes = 8,
  DEM_President_Percentage = 8 / 1351 * 100,  
  REP_President_Undervotes = 41,
  REP_President_Percentage = 41 / 2651 * 100, 
  DEM_Senate_Undervotes = 39,
  DEM_Senate_Percentage = 39 / 1351 * 100,    
  REP_Senate_Undervotes = 40,
  REP_Senate_Percentage = 40 / 2651 * 100,     
  Total_REP_Votes = 2651,  
  Total_DEM_Votes = 1351, 
  Percent_DEM_of_Total = 1351 / (1351 + 2651) * 100,
  stringsAsFactors = FALSE
)

# Append to the data frame
undervotes_df <- rbind(undervotes_df, Caroline_results)

undervotes_df




```

Carroll Undervote
```{r}
glimpse(Carroll)

Carroll |>
  filter(
    `DEM President of the United States (2) (500001630102)`     == "undervote"|
      `DEM President of the United States (3) (500001630103)`   == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (2) (500001630102)`   == "undervote", na.rm = TRUE), 
    `Race 3` = sum(`DEM President of the United States (3) (500001630103)`  == "undervote", na.rm = TRUE)
  )
34	+6	
#40	undervotes for dem president

Carroll |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (2) (500001630102)`  )),
      `Total DEM (3)` = sum(!is.na(`DEM President of the United States (3) (500001630103)`                     )
  ))
9878	+1312	
#11190	total dem pres votes

Carroll |>
  filter(
   `REP President of the United States (2) (500001630202)`         == "undervote" |
    `REP President of the United States (3) (500001630203)`        == "undervote"
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (2) (500001630202)`          == "undervote", na.rm = TRUE),
   `Race 3` = sum( `REP President of the United States (3) (500001630203)`        == "undervote", na.rm = TRUE) )
462	+52	
#514	 undervotes for rep president

Carroll |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (2) (500001630202)`  )),
       `Total rep (3)` = sum(!is.na(`REP President of the United States (3) (500001630203)`  )                       )
  )
17553	+2244	
#19797 total rep primary votes


Carroll |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#288	 undervotes for dem senates

Carroll |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#11190	total dem senate votes

Carroll |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#259	 undervotes for rep senate

Carroll |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#19797		total rep senate votes


Carroll_results <- data.frame(
  County = "Carroll",
  DEM_President_Undervotes = 40,
  DEM_President_Percentage = 40 / 11190 * 100,  
  REP_President_Undervotes = 514,
  REP_President_Percentage = 514 / 19797 * 100, 
  DEM_Senate_Undervotes = 288,
  DEM_Senate_Percentage = 288 / 11190 * 100,    
  REP_Senate_Undervotes = 259,
  REP_Senate_Percentage = 259 / 19797 * 100,     
  Total_REP_Votes = 19797,  
  Total_DEM_Votes = 11190, 
  Percent_DEM_of_Total = 11190 / (11190 + 19797) * 100,
  stringsAsFactors = FALSE
)

# Append to the data frame
undervotes_df <- rbind(undervotes_df, Carroll_results)

undervotes_df




```
Cecil Undervote
```{r}
glimpse(Cecil)

Cecil |>
  filter(
    `DEM President of the United States (1) (500001630101)`     == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (1) (500001630101)`    == "undervote", na.rm = TRUE)
  )
#42		undervotes for dem president

Cecil |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`   ))                     )

#4617	total dem pres votes

Cecil |>
  filter(
   `REP President of the United States (1) (500001630201)`        == "undervote" 
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (1) (500001630201)`         == "undervote", na.rm = TRUE) )
	
#361		 undervotes for rep president

Cecil |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (1) (500001630201)`  )                      )
  )
#14173 total rep primary votes


Cecil |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#208	 undervotes for dem senates

Cecil |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#4617	total dem senate votes

Cecil |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#658	 undervotes for rep senate

Cecil |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#14173		total rep senate votes


Cecil_results <- data.frame(
  County = "Cecil",
  DEM_President_Undervotes = 42,
  DEM_President_Percentage = 42 / 4617 * 100,  
  REP_President_Undervotes = 361,
  REP_President_Percentage = 361 / 14173 * 100, 
  DEM_Senate_Undervotes = 208,
  DEM_Senate_Percentage = 208 / 4617 * 100,    
  REP_Senate_Undervotes = 658,
  REP_Senate_Percentage = 658 / 14173 * 100,     
  Total_REP_Votes = 14173,  
  Total_DEM_Votes = 4617, 
  Percent_DEM_of_Total = 4617 / (4617 + 14173) * 100,
  stringsAsFactors = FALSE
)

# Append to the data frame
undervotes_df <- rbind(undervotes_df, Cecil_results)

undervotes_df




```

Cecil Undervote
```{r}
glimpse(Charles)

Charles |>
  filter(
    `DEM President of the United States (5) (500001630105)`      == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (5) (500001630105)`     == "undervote", na.rm = TRUE)
  )
#94		undervotes for dem president

Charles |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (5) (500001630105)`   ))                     )

#19938	total dem pres votes

Charles |>
  filter(
   `REP President of the United States (5) (500001630205)`    == "undervote" 
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (5) (500001630205)`        == "undervote", na.rm = TRUE) )
	
#151 undervotes for rep president

Charles |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (5) (500001630205)` )                      )
  )
#6141 total rep primary votes


Charles |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#229	 undervotes for dem senates

Charles |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#19938	total dem senate votes

Charles |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#99	 undervotes for rep senate

Charles |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#6141		total rep senate votes


Charles_results <- data.frame(
  County = "Charles",
  DEM_President_Undervotes = 94,
  DEM_President_Percentage = 94 / 19938 * 100,  
  REP_President_Undervotes = 151,
  REP_President_Percentage = 151 / 6141 * 100, 
  DEM_Senate_Undervotes = 229,
  DEM_Senate_Percentage = 229 / 19938 * 100,    
  REP_Senate_Undervotes = 99,
  REP_Senate_Percentage = 99 / 6141 * 100,     
Total_REP_Votes = 6141,  
  Total_DEM_Votes = 19938, 
  Percent_DEM_of_Total = 19938 / (19938 + 6141) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Charles_results)

undervotes_df




```
Dorchester Undervote
```{r}
glimpse(Dorchester)

Dorchester |>
  filter(
    `DEM President of the United States (1) (500001630101)`     == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (1) (500001630101)`    == "undervote", na.rm = TRUE)
  )
#23			undervotes for dem president

Dorchester |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`    ))                     )

#2256	total dem pres votes

Dorchester |>
  filter(
   `REP President of the United States (1) (500001630201)`     == "undervote" 
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (1) (500001630201)`     == "undervote", na.rm = TRUE) )
	
#55 undervotes for rep president

Dorchester |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (1) (500001630201)`  )                      )
  )
#2933 total rep primary votes


Dorchester |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#79	 undervotes for dem senates

Dorchester |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#2256	total dem senate votes

Dorchester |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#61	 undervotes for rep senate

Dorchester |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#2933		total rep senate votes


Dorchester_results <- data.frame(
  County = "Dorchester",
  DEM_President_Undervotes = 23,
  DEM_President_Percentage = 23 / 2256 * 100,  
  REP_President_Undervotes = 55,
  REP_President_Percentage = 55 / 2933 * 100, 
  DEM_Senate_Undervotes = 79,
  DEM_Senate_Percentage = 79 / 2256 * 100,    
  REP_Senate_Undervotes = 61,
  REP_Senate_Percentage = 61 / 2933 * 100,     
Total_REP_Votes = 2933,  
  Total_DEM_Votes = 2256, 
  Percent_DEM_of_Total = 2256 / (2256 + 2933) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Dorchester_results)

undervotes_df


```

Garrett Undervote
```{r}
glimpse(Garrett)

Garrett |>
  filter(
    `DEM President of the United States (6) (500001630106)`      == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (6) (500001630106)`      == "undervote", na.rm = TRUE)
  )
#12			undervotes for dem president

Garrett |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (6) (500001630106)`     ))                     )

#1303	total dem pres votes

Garrett |>
  filter(
   `REP President of the United States (6) (500001630206)`       == "undervote" 
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (6) (500001630206)`    == "undervote", na.rm = TRUE) )
	
#81 undervotes for rep president

Garrett |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (6) (500001630206)` )                      )
  )
#4609 total rep primary votes


Garrett |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#32	 undervotes for dem senates

Garrett |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#1303	total dem senate votes

Garrett |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#108	 undervotes for rep senate

Garrett |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#4609		total rep senate votes


Garrett_results <- data.frame(
  County = "Garrett",
  DEM_President_Undervotes = 12,
  DEM_President_Percentage = 12 / 1303 * 100,  
  REP_President_Undervotes = 81,
  REP_President_Percentage = 81 / 4609 * 100, 
  DEM_Senate_Undervotes = 32,
  DEM_Senate_Percentage = 32 / 1303 * 100,    
  REP_Senate_Undervotes = 108,
  REP_Senate_Percentage = 108 / 4609 * 100,     
Total_REP_Votes = 4609,  
  Total_DEM_Votes = 1303, 
  Percent_DEM_of_Total = 1303 / (1303 + 4609) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Garrett_results)

undervotes_df


```
Harford Undervote
```{r}
glimpse(Harford)

Harford |>
  filter(
    `DEM President of the United States (1) (500001630101)`      == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (1) (500001630101)`        == "undervote", na.rm = TRUE)
  )
#73			undervotes for dem president

Harford |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`    ))                     )

#18055	total dem pres votes

Harford |>
  filter(
  `REP President of the United States (1) (500001630201)`      == "undervote" 
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (1) (500001630201)`   == "undervote", na.rm = TRUE) )
	
#458 undervotes for rep president

Harford |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (1) (500001630201)`)                      )
  )
#24970 total rep primary votes


Harford |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#410	 undervotes for dem senates

Harford |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#18055	total dem senate votes

Harford |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#421	 undervotes for rep senate

Harford |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#24970		total rep senate votes


Harford_results <- data.frame(
  County = "Harford",
  DEM_President_Undervotes = 73,
  DEM_President_Percentage = 73 / 18055 * 100,  
  REP_President_Undervotes = 458,
  REP_President_Percentage = 458 / 24970 * 100, 
  DEM_Senate_Undervotes = 410,
  DEM_Senate_Percentage = 410 / 18055 * 100,    
  REP_Senate_Undervotes = 421,
  REP_Senate_Percentage = 421 / 24970 * 100,     
Total_REP_Votes = 24970,  
  Total_DEM_Votes = 18055, 
  Percent_DEM_of_Total = 18055 / (18055 + 24970) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Harford_results)

undervotes_df


```

Kent Undervote
```{r}
glimpse(Kent)

Kent |>
  filter(
    `DEM President of the United States (1) (500001630101)`      == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (1) (500001630101)`        == "undervote", na.rm = TRUE)
  )
#15	undervotes for dem president

Kent |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`    ))                     )

#2090	total dem pres votes

Kent |>
  filter(
  `REP President of the United States (1) (500001630201)`      == "undervote" 
  ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (1) (500001630201)`   == "undervote", na.rm = TRUE) )
	
#46 undervotes for rep president

Kent |>
  summarize(
       `Total rep (2)` = sum(!is.na(`REP President of the United States (1) (500001630201)`)                      )
  )
#1856 total rep primary votes


Kent |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#52	 undervotes for dem senates

Kent |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#2090	total dem senate votes

Kent |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#19	 undervotes for rep senate

Kent |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#1856		total rep senate votes



Kent_results <- data.frame(
  County = "Kent",
  DEM_President_Undervotes = 15,
  DEM_President_Percentage = 15 / 2090 * 100,  
  REP_President_Undervotes = 46,
  REP_President_Percentage = 46 / 1856 * 100, 
  DEM_Senate_Undervotes = 52,
  DEM_Senate_Percentage = 52 / 2090 * 100,    
  REP_Senate_Undervotes = 19,
  REP_Senate_Percentage = 19 / 1856 * 100,     
Total_REP_Votes = 1856,  
  Total_DEM_Votes = 2090, 
  Percent_DEM_of_Total = 2090 / (2090 + 1856) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Kent_results)

undervotes_df


```


PG Undervote
```{r}
glimpse(PG)

PG |>
  filter(
    `DEM President of the United States (4) (500001630104)`     == "undervote" |
      `DEM President of the United States (5) (500001630105)`   == "undervote"|
      `DEM President of the United States (8) (500001630108)`        == "undervote"
  ) |>
  summarize(
    `Race 4` = sum( `DEM President of the United States (4) (500001630104)`          == "undervote", na.rm = TRUE),
    `Race 5` = sum( `DEM President of the United States (5) (500001630105)`       == "undervote", na.rm = TRUE),
    `Race 8` = sum( `DEM President of the United States (8) (500001630108)`         == "undervote", na.rm = TRUE)
  )

241	+137+	0	
#378	undervotes for dem president

PG |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (4) (500001630104)`     )),
        `Total DEM (5)` = sum(!is.na( `DEM President of the United States (5) (500001630105)`  ) ),
           `Total DEM (8)` = sum(!is.na(`DEM President of the United States (8) (500001630108)`       ))           )
56501 +	35699	+0	
#92200	total dem pres votes

PG |>
  filter(
    `REP President of the United States (4) (500001630204)`      == "undervote" |
      `REP President of the United States (5) (500001630205)`    == "undervote"|
      `REP President of the United States (8) (500001630208)`    == "undervote"
  ) |>
  summarize(
    `Race 4` = sum( `REP President of the United States (4) (500001630204)`           == "undervote", na.rm = TRUE),
    `Race 5` = sum( `REP President of the United States (5) (500001630205)`      == "undervote", na.rm = TRUE),
    `Race 8` = sum( `REP President of the United States (8) (500001630208)`          == "undervote", na.rm = TRUE)
  )
141	+101+	0		
#242 undervotes for rep president

PG |>
  summarize(
    `Total Rep (4)` = sum(!is.na(`REP President of the United States (4) (500001630204)`     )),
        `Total Rep (5)` = sum(!is.na( `REP President of the United States (5) (500001630205)`  ) ),
           `Total Rep (8)` = sum(!is.na(`REP President of the United States (8) (500001630208)`       ))           )
3699	+2459+	0	
#6158 total rep primary votes


PG |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#520		 undervotes for dem senates

PG |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#92202	total dem senate votes

PG |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#146	 undervotes for rep senate

PG |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#6158		total rep senate votes


PG_results <- data.frame(
  County = "Prince George's",
  DEM_President_Undervotes = 378,
  DEM_President_Percentage = 378 / 92200 * 100,  
  REP_President_Undervotes = 242,
  REP_President_Percentage = 242 / 6158 * 100, 
  DEM_Senate_Undervotes = 520,
  DEM_Senate_Percentage = 520 / 92202 * 100,    
  REP_Senate_Undervotes = 146,
  REP_Senate_Percentage = 146 / 6158 * 100,     
Total_REP_Votes = 6158,  
  Total_DEM_Votes = 92200, 
  Percent_DEM_of_Total = 92200 / (92200 + 6158) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, PG_results)

undervotes_df


```

QueenAnnes Undervote
```{r}
glimpse(QueenAnnes)

QueenAnnes |>
  filter(
    `DEM President of the United States (1) (500001630101)`       == "undervote"
  ) |>
  summarize(
    `Race 4` = sum( `DEM President of the United States (1) (500001630101)`   == "undervote", na.rm = TRUE)
  )

#15	undervotes for dem president

QueenAnnes |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`  ))           )
#3579		total dem pres votes

QueenAnnes |>
  filter(
    `REP President of the United States (1) (500001630201)`      == "undervote" 
  ) |>
  summarize(
    `Race 4` = sum( `REP President of the United States (1) (500001630201)`        == "undervote", na.rm = TRUE)
  )
#89	 undervotes for rep president

QueenAnnes |>
  summarize(
    `Total Rep (4)` = sum(!is.na(`REP President of the United States (1) (500001630201)`    ))           )
#5996 total rep primary votes


QueenAnnes |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#79		 undervotes for dem senates

QueenAnnes |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#3579	total dem senate votes

QueenAnnes |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#82	 undervotes for rep senate

QueenAnnes |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#5996		total rep senate votes


QueenAnnes_results <- data.frame(
  County = "Queen Anne's",
  DEM_President_Undervotes = 15,
  DEM_President_Percentage = 15 / 3579 * 100,  
  REP_President_Undervotes = 89,
  REP_President_Percentage = 89 / 5996 * 100, 
  DEM_Senate_Undervotes = 79,
  DEM_Senate_Percentage = 79 / 3579 * 100,    
  REP_Senate_Undervotes = 82,
  REP_Senate_Percentage = 82 / 5996 * 100,     
Total_REP_Votes = 5996,  
  Total_DEM_Votes = 3579, 
  Percent_DEM_of_Total = 3579 / (3579 + 5996) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, QueenAnnes_results)

undervotes_df


```

StMarys Undervote
```{r}
glimpse(StMarys)

StMarys |>
  filter(
    `DEM President of the United States (5) (500001630105)`  == "undervote"
  ) |>
  summarize(
    `Race 4` = sum( `DEM President of the United States (5) (500001630105)`   == "undervote", na.rm = TRUE)
  )

#86		undervotes for dem president

StMarys |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (5) (500001630105)` ))           )
#7464		total dem pres votes

StMarys |>
  filter(
    `REP President of the United States (5) (500001630205)`     == "undervote" 
  ) |>
  summarize(
    `Race 4` = sum( `REP President of the United States (5) (500001630205)`     == "undervote", na.rm = TRUE)
  )
#263	 undervotes for rep president

StMarys |>
  summarize(
    `Total Rep (4)` = sum(!is.na(`REP President of the United States (5) (500001630205)`  ))           )
#10936 total rep primary votes


StMarys |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#329		 undervotes for dem senates

StMarys |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#7464	total dem senate votes

StMarys |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#237	 undervotes for rep senate

StMarys |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#10936		total rep senate votes


StMarys_results <- data.frame(
  County = "Saint Mary's",
  DEM_President_Undervotes = 86,
  DEM_President_Percentage = 86 / 7464 * 100,  
  REP_President_Undervotes = 263,
  REP_President_Percentage = 263 / 10936 * 100, 
  DEM_Senate_Undervotes = 329,
  DEM_Senate_Percentage = 329 / 7464 * 100,    
  REP_Senate_Undervotes = 237,
  REP_Senate_Percentage = 237 / 10936 * 100,     
  Total_REP_Votes = 10936,  
  Total_DEM_Votes = 7464, 
  Percent_DEM_of_Total = 7464 / (7464 + 10936) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, StMarys_results)

undervotes_df


```


Somerset Undervote
```{r}
glimpse(Somerset)

Somerset |>
  filter(
    `DEM President of the United States (1) (500001630101)`   == "undervote"
  ) |>
  summarize(
    `Race 4` = sum(`DEM President of the United States (1) (500001630101)`   == "undervote", na.rm = TRUE)
  )

#8 undervotes for dem president

Somerset |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`  ))           )
#999	total dem pres votes

Somerset |>
  filter(
    `REP President of the United States (1) (500001630201)`  == "undervote" 
  ) |>
  summarize(
    `Race 4` = sum( `REP President of the United States (1) (500001630201)`       == "undervote", na.rm = TRUE)
  )
#27	undervotes for rep president

Somerset |>
  summarize(
    `Total Rep (4)` = sum(!is.na(`REP President of the United States (1) (500001630201)`))     )
#1752 total rep primary votes


Somerset |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#36 undervotes for dem senates

Somerset |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#999	total dem senate votes

Somerset |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#21	 undervotes for rep senate

Somerset |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#1752		total rep senate votes



Somerset_results <- data.frame(
  County = "Somerset",
  DEM_President_Undervotes = 8,
  DEM_President_Percentage = 8 / 999 * 100,  
  REP_President_Undervotes = 27,
  REP_President_Percentage = 27 / 1752 * 100, 
  DEM_Senate_Undervotes = 36,
  DEM_Senate_Percentage = 36 / 999 * 100,    
  REP_Senate_Undervotes = 21,
  REP_Senate_Percentage = 21 / 1752 * 100,     
 Total_REP_Votes = 1752,  
  Total_DEM_Votes = 999, 
  Percent_DEM_of_Total = 999 / (999 + 1752) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Somerset_results)

undervotes_df


```


Talbot Undervote
```{r}
glimpse(Talbot)

Talbot |>
  filter(
    `DEM President of the United States (1) (500001630101)`   == "undervote"
  ) |>
  summarize(
    `Race 4` = sum(`DEM President of the United States (1) (500001630101)`   == "undervote", na.rm = TRUE)
  )

#19 undervotes for dem president

Talbot |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`  ))           )
#3920	total dem pres votes

Talbot |>
  filter(
    `REP President of the United States (1) (500001630201)`  == "undervote" 
  ) |>
  summarize(
    `Race 4` = sum( `REP President of the United States (1) (500001630201)`       == "undervote", na.rm = TRUE)
  )
#93	undervotes for rep president

Talbot |>
  summarize(
    `Total Rep (4)` = sum(!is.na(`REP President of the United States (1) (500001630201)`))     )
#3940 total rep primary votes


Talbot |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#83 undervotes for dem senates

Talbot |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#3920	total dem senate votes

Talbot |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#46	 undervotes for rep senate

Talbot |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#3940		total rep senate votes


Talbot_results <- data.frame(
  County = "Talbot",
  DEM_President_Undervotes = 19,
  DEM_President_Percentage = 19 / 3920 * 100,  
  REP_President_Undervotes = 93,
  REP_President_Percentage = 93 / 3940 * 100, 
  DEM_Senate_Undervotes = 83,
  DEM_Senate_Percentage = 83 / 3920 * 100,    
  REP_Senate_Undervotes = 46,
  REP_Senate_Percentage = 46 / 3940 * 100,     
  Total_REP_Votes = 3940,  
  Total_DEM_Votes = 3920, 
  Percent_DEM_of_Total = 3920 / (3920 + 3940) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Talbot_results)

undervotes_df


```

Washington Undervote
```{r}
glimpse(Washington)

Washington |>
  filter(
    `DEM President of the United States (6) (500001630106)`    == "undervote"
  ) |>
  summarize(
    `Race 4` = sum(`DEM President of the United States (6) (500001630106)`   == "undervote", na.rm = TRUE)
  )

#122	 undervotes for dem president

Washington |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (6) (500001630106)`  ))           )
#8980	total dem pres votes

Washington |>
  filter(
    `REP President of the United States (6) (500001630206)`    == "undervote" 
  ) |>
  summarize(
    `Race 4` = sum( `REP President of the United States (6) (500001630206)`       == "undervote", na.rm = TRUE)
  )
#355		undervotes for rep president

Washington |>
  summarize(
    `Total Rep (4)` = sum(!is.na(`REP President of the United States (6) (500001630206)`  ))     )
#14039 total rep primary votes


Washington |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#246 undervotes for dem senates

Washington |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#8980	total dem senate votes

Washington |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#448	 undervotes for rep senate

Washington |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#14039		total rep senate votes


Washington_results <- data.frame(
  County = "Washington",
  DEM_President_Undervotes = 122,
  DEM_President_Percentage = 122 / 8980 * 100,  
  REP_President_Undervotes = 355,
  REP_President_Percentage = 355 / 14039 * 100, 
  DEM_Senate_Undervotes = 246,
  DEM_Senate_Percentage = 246 / 8980 * 100,    
  REP_Senate_Undervotes = 448,
  REP_Senate_Percentage = 448 / 14039 * 100,     
  Total_REP_Votes = 14039,  
  Total_DEM_Votes = 8980, 
  Percent_DEM_of_Total = 8980 / (8980 + 14039) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Washington_results)

undervotes_df


```


Wicomico Undervote
```{r}
glimpse(Wicomico)

Wicomico |>
  filter(
    `DEM President of the United States (1) (500001630101)`    == "undervote"
  ) |>
  summarize(
    `Race 4` = sum(`DEM President of the United States (1) (500001630101)`   == "undervote", na.rm = TRUE)
  )

#32		 undervotes for dem president

Wicomico |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`  ))           )
#5637	total dem pres votes

Wicomico |>
  filter(
    `REP President of the United States (1) (500001630201)`    == "undervote" 
  ) |>
  summarize(
    `Race 4` = sum( `REP President of the United States (1) (500001630201)`     == "undervote", na.rm = TRUE)
  )
#140		undervotes for rep president

Wicomico |>
  summarize(
    `Total Rep (4)` = sum(!is.na(`REP President of the United States (1) (500001630201)`   ))     )
#6739 total rep primary votes


Wicomico |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#194 undervotes for dem senates

Wicomico |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#5637	total dem senate votes

Wicomico |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#72	 undervotes for rep senate

Wicomico |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#6739		total rep senate votes


Wicomico_results <- data.frame(
  County = "Wicomico",
  DEM_President_Undervotes = 32,
  DEM_President_Percentage = 32 / 5637 * 100,  
  REP_President_Undervotes = 140,
  REP_President_Percentage = 140 / 6739 * 100, 
  DEM_Senate_Undervotes = 194,
  DEM_Senate_Percentage = 194 / 5637 * 100,    
  REP_Senate_Undervotes = 72,
  REP_Senate_Percentage = 72 / 6739 * 100,     
  Total_REP_Votes = 6739,  
  Total_DEM_Votes = 5637, 
  Percent_DEM_of_Total = 5637 / (5637 + 6739) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Wicomico_results)

undervotes_df


```


Worcester Undervote
```{r}
glimpse(Worcester)

Worcester |>
  filter(
    `DEM President of the United States (1) (500001630101)`    == "undervote"
  ) |>
  summarize(
    `Race 4` = sum(`DEM President of the United States (1) (500001630101)`   == "undervote", na.rm = TRUE)
  )

#16		 undervotes for dem president

Worcester |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`  ))           )
#3947	total dem pres votes

Worcester |>
  filter(
    `REP President of the United States (1) (500001630201)`    == "undervote" 
  ) |>
  summarize(
    `Race 4` = sum( `REP President of the United States (1) (500001630201)`     == "undervote", na.rm = TRUE)
  )
#135		undervotes for rep president

Worcester |>
  summarize(
    `Total Rep (4)` = sum(!is.na(`REP President of the United States (1) (500001630201)`   ))     )
#6247 total rep primary votes


Worcester |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#	208 undervotes for dem senates

Worcester |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#3947	total dem senate votes

Worcester |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#82	 undervotes for rep senate

Worcester |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#6247		total rep senate votes


Worcester_results <- data.frame(
  County = "Worcester",
  DEM_President_Undervotes = 16,
  DEM_President_Percentage = 16 / 3947 * 100,  
  REP_President_Undervotes = 135,
  REP_President_Percentage = 135 / 6247 * 100, 
  DEM_Senate_Undervotes = 208,
  DEM_Senate_Percentage = 208 / 3947 * 100,    
  REP_Senate_Undervotes = 82,
  REP_Senate_Percentage = 82 / 6247 * 100,     
  Total_REP_Votes = 6247,  
  Total_DEM_Votes = 3947, 
  Percent_DEM_of_Total = 3947 / (3947 + 6247) * 100,
  stringsAsFactors = FALSE
)


undervotes_df <- rbind(undervotes_df, Worcester_results)

undervotes_df


```


```{r}
library(tigris)
library(ggplot2)
library(sf)
counties <- counties()

glimpse(counties)
md_counties <- counties |>
  filter(STATEFP == "24")

glimpse(md_counties)
glimpse(undervotes_df)
  
  md_counties$NAME
  undervotes_df$County
  
  library(dplyr)

undervotes_df <- undervotes_df %>%
  mutate(Difference_Undervotes_pres = REP_President_Percentage -DEM_President_Percentage
                                  )


 undervotes_df <- undervotes_df %>%
  mutate(County = case_when(
    County == "Alleghany" ~ "Allegany",  
    County == "Anne Arundel" ~ "Anne Arundel",  
    County == "Saint Mary's" ~ "St. Mary's",    
    County == "Baltimore City" ~ "Baltimore City",  
    County == "Baltimore County" ~ "Baltimore", 
    TRUE ~ County  # Keep other names as is
  ))
 undervotemap <- md_counties %>%
  left_join(undervotes_df, by = c("NAME" = "County"))
 
  ggplot(data = undervotemap) +
  geom_sf(aes(fill = REP_President_Percentage)) + 
  scale_fill_viridis_c(option = "magma") +  
  theme_minimal() +                         
  labs(
    title = "Republican Presidential Undervote Percentage by County",
    fill = "Rep % Undervotes"
  )
  
    ggplot(data = undervotemap) +
  geom_sf(aes(fill = DEM_President_Percentage)) + 
  scale_fill_viridis_c(option = "magma") +  
  theme_minimal() +                         
  labs(
    title = "Democratic Presidential Undervote Percentage by County",
    fill = "Dem % Undervotes"
  )
 
  
  ggplot(data = undervotemap) +
  geom_sf(aes(fill = Percent_DEM_of_Total)) + 
  scale_fill_viridis_c(option = "magma") +  
  theme_minimal() +                         
  labs(
    title = "Percentage of Democratic Voters that Voted in Primary",
    fill = "Dem % Votes"
  )
  
  
   ggplot(data = undervotemap) +
  geom_sf(aes(fill = Difference_Undervotes_pres)) + 
  scale_fill_viridis_c(option = "magma") +  
  theme_minimal() +                         
  labs(
    title = "Percentage Undervotes Republican Minus Democrat",
    fill = "Difference in Undervotes"
  )
  
   
   summary(undervotes_df$DEM_President_Percentage)
   #Mean 0.6889
   summary(undervotes_df$REP_President_Percentage)
   #Mean 2.360
   summary(undervotes_df$Difference_Undervotes_pres)
   #Mean 1.67
```

Undervotes are when those who voted elsewhere on the ballot skip over or avoid voting for a specific race. Since the presidential race gets the most press and often brings people to the polls it is surprising when someone who comes out to vote avoids voting for president. Our data is primary data. We find that Republicans were more likely across all counties to undervote for president than Democrats. The difference between their undervoting rates is even greater in more Democratic counties. This was particularly true for counties surrounding DC such as Prince George's County, Montgomery County, Carroll County, and Howard County. This greater undervoting by Republicans can show a displeasure with their choices for presidential candidates especially for those in more Democratic counties. Although we do not have data on their ideology I think there might be more moderate Republicans or Independents that vote in the Republican primary in these districts. This could indicate that as the Republican party moves more to the right nationally some Republican voters would rather avoid voting for the presidential options given because they don't align with their ideas. 

Results of undervotes for each race and county
Montgomery County
President
dem 0.4%
rep 2.9%
senate
dem 1.2%
rep 1.8%


Howard County
President
dem 0.5%
rep 3.2%
senate
dem 2.1%
rep 1.6%

Frederick County
President
dem 0.6%
rep 2.4%
senate
dem 1.8%
rep 2.2%

Baltimore City
President
dem 1.3%
rep 4.3%
senate
dem 3.3%
rep 3.5%


Baltimore County
President
dem 0.5%
rep 2.0%
senate
dem 1.7%
rep 1.6%

Across the 5 counties Republicans had a higher undervote percentage with the average being 2.3% higher than Democrats. Republicans undervoted more than Democrats for Senate but the difference is much smaller (an average of 0.12%) This might show that Republicans in Maryland are less happy with their options for president in the primary than Democrats were. 

